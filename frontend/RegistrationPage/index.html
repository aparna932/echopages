<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Register | Public Diary</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <div id="tsparticles"></div>

    <div class="logo-container">
        <img src="logo.png" alt="Logo" class="logo" />
    </div>

    <div class="register-box">
        <h2>Register</h2>

        <form id="registerForm" action="/api/users/register" method="POST">
            <input type="text" name="name" placeholder="Full Name" required />
            <input type="email" name="email" placeholder="Email" required />
            <input type="password" name="password" placeholder="Password" required />
            <input type="password" name="confirmPassword" placeholder="Confirm Password" required />
            <button type="submit">Register</button>
        </form>

        <script>
            document.getElementById('registerForm').addEventListener('submit', async (e) => {
                e.preventDefault();

                const name = e.target.name.value;
                const email = e.target.email.value;
                const password = e.target.password.value;
                const confirmPassword = e.target.confirmPassword.value;

                if (password !== confirmPassword) {
                    alert("❌ Passwords do not match");
                    return;
                }

                try {
                    const response = await fetch('https://webdiary-backend-7.onrender.com/api/users/register', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ name, email, password, confirmPassword })
                    });

                    const data = await response.json();

                    if (response.ok) {
                        alert("✅ " + data.message);
                        window.location.href = "/LoginPage/index.html";
                    } else {
                        alert("❌ " + (data.error || "Registration failed"));
                    }
                } catch (error) {
                    alert("❌ Network error or server is down");
                }
            });
        </script>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tsparticles/1.18.1/tsparticles.min.js"
        integrity="sha512-PYHWDEuXOTJ9MZ+/QHqkbgiEYZ+LImQv3i/9NyYOABFvK37e4q4Wg7aQDN1JpoGiEu1TYZh6JMrZluZox2gbDA=="
        crossorigin="anonymous"></script>
    <script src="script.js"></script>
</body>

</html>
